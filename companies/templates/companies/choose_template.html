<!-- companies/templates/companies/choose_template.html -->
{% extends "admin/base_site.html" %}

{% block content %}
<h1>Generate document for: {{ company.company_name }}</h1>

{% if templates %}
  <form method="post">
    {% csrf_token %}
    
    <!-- Select Template -->
    <label for="template_id">Choose template:</label>
    <select name="template_id" id="template_id">
      {% for category, templates_in_category in templates_by_category %}
        <optgroup label="{{ category }}">
          {% for t in templates_in_category %}
            <option value="{{ t.id }}">{{ t.name }}</option>
          {% endfor %}
        </optgroup>
      {% endfor %}
    </select>
    <br><br>

    <!-- Select Director -->
    <label for="director_id">Choose director:</label>
    <select name="director_id" id="director_id">
      <option value="all">All Directors</option>
      {% for director in company.director_set.all %}
        <option value="{{ director.id }}">{{ director.full_name }}</option>
      {% endfor %}
    </select>
    <br><br>

    <!-- Action Buttons -->
    <button type="submit" name="action" value="generate">Generate</button>
    <button type="submit" name="action" value="preview">Preview</button>
    <button type="submit" name="action" value="email">Email to Client</button>
  </form>
{% else %}
  <p>No templates found. Go to Admin â†’ Document Templates to upload .docx templates.</p>
{% endif %}

<p><a href="{% url 'admin:companies_documenttemplate_changelist' %}">Open Document Templates (Admin)</a></p>
{% endblock %}
